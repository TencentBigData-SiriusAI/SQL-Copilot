SELECT * FROM (SELECT t1.c1, t1.c2 AS c2_alias, t1.c3, t1.c4, max(t1.c5) AS c5_alias FROM t1 WHERE t1.c1 IN (v1) AND t1.c1 IN (v2, v3) AND t1.c3 IN (v4, v5, v6) AND t1.c4 BETWEEN v7 AND v8 AND t1.c6 = v9 AND t1.c5 = 0 GROUP BY t1.c1, t1.c2, t1.c3, t1.c4) a0 LEFT JOIN (SELECT t3.* FROM t2 t3 JOIN (SELECT c2, MAX(c4) AS c4_alias FROM t2 WHERE c4 > v10 GROUP BY c2) t2 ON t3.c2 = t2.c2 AND t3.c4 = t2.c4 WHERE t3.c4 > v10) a1 ON a0.c2_alias = a1.c2 WHERE ((c3 = v4 AND c1 = v2) AND ((c7 = v11) OR (c8 = v12 AND c9 IN (v13, v14, v15, v16)) OR (c8 = v12 AND c10 IN (v17)) OR (c8 = v12 AND c11 LIKE v18) OR (c8 = v12 AND c12 IN (v19, v20)))) OR ((c3 = v5 AND c1 = v2) AND ((c13 = v21) OR (c8 = v12 AND c14 IN (v22, v23)) OR (c8 = v12 AND c9 IN (v13)) OR (c8 = v12 AND c10 IN (v24, v25)) OR (c8 = v12 AND c11 LIKE v26) OR (c8 = v12 AND c15 IN (v27, v28)) OR (c8 = v12 AND c12 IN (v19, v20)))) OR (c3 = v6) OR (c3 = v4 AND c1 = v3) OR (c3 = v5 AND c1 = v3)
SELECT COUNT(*) AS c1, c2, c3 FROM (SELECT CASE WHEN IFNULL(c2, 'v1') = 'v2' THEN 'v2' ELSE 'v3' END AS c2, CASE WHEN ((CONCAT(NVL(c4, ''), NVL(c5, '')) RLIKE 'v4' AND CONCAT(NVL(c4, ''), NVL(c5, '')) NOT RLIKE 'v5') OR (NVL(c6, '') RLIKE 'v6' AND NVL(c6, '') NOT RLIKE 'v7') OR (CONCAT(NVL(c7, ''), NVL(c8, ''), NVL(c9, '')) RLIKE 'v4') OR (CONCAT(NVL(c10, ''), NVL(c11, ''), NVL(c12, ''), NVL(c13, '')) RLIKE 'v8' AND CONCAT(NVL(c10, ''), NVL(c11, ''), NVL(c12, ''), NVL(c13, '')) NOT RLIKE 'v9')) AND NVL(c14, '') NOT RLIKE 'v10' THEN 'v2' ELSE 'v3' END AS c3 FROM t1 t1 WHERE t1.c15 = 'v11' AND c16 IS NOT NULL) GROUP BY c2, c3 ;
SELECT t1.c1 AS c1, t1.c2 AS c2, t1.c3 AS c3, t1.c4 AS c4, t1.c5 AS c5, t1.c6 AS c6, t1.c7 AS c7, t1.c8 AS c8 FROM (SELECT t2.c9 AS c1, t2.c10 AS c2, t2.c11 AS c3, t2.c12 AS c4, t2.c13 AS c5, t2.c14 AS c6, t2.c15 AS c7, t2.c16 AS c8 FROM (SELECT c17, c18, c19, c20, c21, c22, c23, c24 FROM t3 WHERE c25 >= v1 AND c19 = v2 AND c26 IN (v3, v4) AND c21 = v5 AND c23 > v6 UNION ALL SELECT c17, c18, c19, c20, c21, c22, c23, c24 FROM (SELECT * FROM t4 WHERE c19 = v2 AND c25 = v7) t WHERE c26 IN (v3, v4) AND c21 = v5 AND c23 > v6) t2 LEFT JOIN (SELECT * FROM t4 WHERE c27 = v8 AND c19 = v2) t5 ON t2.c19 = t5.c19 WHERE t5.c19 IS NOT NULL AND t5.c28 <= v9) t1 LEFT JOIN (SELECT t6.c18 AS c3, t6.c17 AS c4, t6.c29 FROM (SELECT c17, c18, c19, c23, c29 FROM t3 WHERE c25 >= v1 AND c26 IN (v10, v11) AND c21 = v5) t6 LEFT JOIN (SELECT * FROM t4 WHERE c27 = v8 AND c19 = v2) t5 ON t6.c19 = t5.c19 WHERE t5.c19 IS NOT NULL AND t5.c28 <= v9) t7 ON t1.c4 = t7.c4 WHERE t7.c4 IS NULL OR (t1.c7 != t7.c29)
SELECT column1, column2, column3, column4, column5, column6, column7, column8, column9, column10, CASE WHEN column11 IS NULL THEN NULL WHEN column11 = '' THEN '' ELSE cast( sm4_GCMDecryptNoPadding( hive_unbase64(substr(column11, 68)), `binary`(k.column0), hive_unbase64(substr(column11, 26, 16)), 12, hive_unbase64(substr(column11, 1, 24)), hive_unbase64(substr(column11, 43, 24)) ) AS STRING ) END AS column11, CASE WHEN column12 IS NULL THEN NULL WHEN column12 = '' THEN '' ELSE cast( sm4_GCMDecryptNoPadding( hive_unbase64(substr(column12, 68)), `binary`(k.column0), hive_unbase64(substr(column12, 26, 16)), 12, hive_unbase64(substr(column12, 1, 24)), hive_unbase64(substr(column12, 43, 24)) ) AS STRING ) END AS column12, CASE WHEN column13 IS NULL THEN NULL WHEN column13 = '' THEN '' ELSE cast( sm4_GCMDecryptNoPadding( hive_unbase64(substr(column13, 68)), `binary`(k.column0), hive_unbase64(substr(column13, 26, 16)), 12, hive_unbase64(substr(column13, 1, 24)), hive_unbase64(substr(column13, 43, 24)) ) AS STRING ) END AS column13, CASE WHEN column14 IS NULL THEN NULL WHEN column14 = '' THEN '' ELSE cast( sm4_GCMDecryptNoPadding( hive_unbase64(substr(column14, 68)), `binary`(k.column0), hive_unbase64(substr(column14, 26, 16)), 12, hive_unbase64(substr(column14, 1, 24)), hive_unbase64(substr(column14, 43, 24)) ) AS STRING ) END AS column14, column15, column16, column17, column18, CASE WHEN column19 IS NULL THEN NULL WHEN column19 = '' THEN '' ELSE cast( sm4_GCMDecryptNoPadding( hive_unbase64(substr(column19, 68)), `binary`(k.column0), hive_unbase64(substr(column19, 26, 16)), 12, hive_unbase64(substr(column19, 1, 24)), hive_unbase64(substr(column19, 43, 24)) ) AS STRING ) END AS column19, column20, column21, column22, column23, column24, column25, column26, unix_timestamp(column26, 'yyyy-MM-dd HH:mm:ss') AS column26, unix_timestamp(column27, 'yyyy-MM-dd HH:mm:ss') AS column27, column28, column29, column30, column31, column32, column33, column34, column35, column36, column37, column38, unix_timestamp(column39, 'yyyy-MM-dd HH:mm:ss') AS column39 FROM table0 partition(p_20250101) p JOIN ( SELECT column0 FROM table0 LIMIT 1 ) k ON (1 = 1) WHERE column1 = 100010000
SELECT count(*) FROM (SELECT c1, c2, c3, c4, c5, c6, c7, c8 FROM t1 WHERE c9 = v1 AND c10 = v2 AND c11 = v3) t2 LEFT OUTER JOIN (SELECT c12, c13, c14, c15, c16, c17, c18, c19, c20, c21, c22, c23, c24, c25, c26, c27, c28, c29 FROM (SELECT c12, c13, c14, c15, c16, c17, c18, c19, c20, c21, c22, c23, c24, c25, c26, c27, c28, c29, ROW_NUMBER() OVER (PARTITION BY c17, c25 ORDER BY c12 DESC, c26 DESC) AS c30 FROM (SELECT c12, c13, c14, c15, c16, c17, c18, c19, c20, c21, c22, c23, c24, c25, c26, c27, c28, c29 FROM t3 WHERE c9 = v1 UNION ALL SELECT CAST(c12 AS BIGINT) AS c12, c13, c14, c15, CAST(c16 AS BIGINT) AS c16, CAST(c17 AS BIGINT) AS c17, CAST(c18 AS BIGINT) AS c18, CAST(c19 AS BIGINT) AS c19, CAST(c20 AS BIGINT) AS c20, CASE WHEN array_contains(split(c31, ';'), v4) THEN unbase64(c22) ELSE c22 END AS c22, CAST(c23 AS BIGINT) AS c23, c24, CAST(c25 AS BIGINT) AS c25, CAST(c26 AS BIGINT) AS c26, CASE WHEN array_contains(split(c31, ';'), v5) THEN unbase64(c27) ELSE c27 END AS c27, CASE WHEN array_contains(split(c31, ';'), v6) THEN unbase64(c28) ELSE c28 END AS c28, CASE WHEN array_contains(split(c31, ';'), v7) THEN unbase64(c29) ELSE c29 END AS c29 FROM t4 WHERE c32 >= v8 AND c32 <= v9 AND c15 NOT LIKE v10)) WHERE c30 = v11) t5 ON (t2.c2 = t5.c17 AND t2.c6 = t5.c25 AND t2.c1 = t5.c15 AND t2.c7 = t5.c27 AND t2.c8 = t5.c28) WHERE t5.c17 IS NULL
SELECT CASE WHEN t1.c1 = 'v1' THEN 'v2' WHEN t1.c1 = 'v3' THEN 'v4' WHEN t1.c1 = 'v5' THEN 'v6' WHEN t1.c1 = 'v7' THEN 'v8' WHEN t1.c1 = 'v9' THEN 'v10' WHEN t1.c1 = 'v11' THEN 'v12' WHEN t1.c1 = 'v13' THEN 'v14' WHEN t1.c1 = 'v15' THEN 'v16' WHEN t1.c1 = 'v17' THEN 'v18' WHEN t1.c1 = 'v19' THEN 'v20' END AS c2, t1.c3, t1.c4 FROM (SELECT 'v1' AS c1, COUNT(*) AS c3, COUNT(DISTINCT t2.c5) AS c4 FROM t1 WHERE t2.c6 >= 1213 AND t2.c6 <= 1215 AND t2.c7 = 1 AND t2.c8 = 0 UNION ALL SELECT t3.c9 AS c1, COUNT(*) AS c3, COUNT(DISTINCT t3.c5) AS c4 FROM t2 WHERE t3.c10 >= 1213 AND t3.c10 <= 1215 AND t3.c9 IN ('v17', 'v18', 'v13', 'v14', 'v3', 'v5', 'v7', 'v9', 'v11') AND get_json_object(t3.c11, 'str0') = 1 GROUP BY t3.c9) t1
SELECT t1.c1, t1.c2, t1.c3, IF(t1.c4 IS NULL OR t1.c4 = '', t1.c2, t1.c4) c4, t1.c5, t1.c6, t1.c7, t1.c8, nvl(t1.c9, t1.c3) c9, nvl(t1.c10, t1.c11) c10, t1.c11, IF(t1.c10 IS NULL OR t1.c10 = t1.c11, 0, 1) c12 FROM (SELECT t2.c1, max(t2.c2) c2, max(t2.c3) c3, t2.c4, max(t2.c5) c5, max(t2.c6) c6, max(t2.c7) c7, max(t2.c8) c8, max(t2.c9) c9, max(t2.c10) c10, max(t2.c11) c11, t2.c12 FROM (SELECT t3.c1 c1, t3.c2 c2, max(IF(t3.c3 = '', NULL, t3.c3)) c3, regexp_extract(t3.c2, '(^[a-z_]+_|^wx)([a-z0-9]+)', 2) c4, max(IF(t3.c5 = '', NULL, t3.c5)) c5, max(IF(t3.c6 = '', NULL, t3.c6)) c6, max(IF(t3.c7 = '', NULL, t3.c7)) c7, max(IF(t3.c8 = '', NULL, t3.c8)) c8, max(IF(t3.c9 = '' OR t3.c9 = '0', NULL, t3.c9)) c9, max(IF(t3.c10 = '' OR t3.c10 = '0', NULL, t3.c10)) c10, max(IF(t3.c7 IS NOT NULL OR t3.c7 != '', t3.c7, t3.c8)) c11, t3.c12 c12 FROM t3 p WHERE t3.c2 IS NOT NULL AND t3.c2 != '' AND t3.c2 != '0' AND t3.c1 > 0 AND t3.c12 IS NOT NULL AND t3.c12 != '' AND t3.c12 != '0' GROUP BY t3.c2, t3.c1, t3.c12) GROUP BY t2.c4, t2.c1, t2.c12) WHERE t1.c4 = 'v1'
SELECT t1.c1, t1.c2, t1.c3, count(DISTINCT t1.c4) AS c5, sum(t1.c6) AS c7, sum(t1.c8) / 100 AS c9, sum(t1.c10) / 100 AS c11, sum(t1.c10) / 900 AS c12 FROM (SELECT t2.c4, t2.c1, t3.c13, t3.c6, t3.c8, t3.c10, t4.c2, t5.c3 FROM (SELECT t6.c1, t6.c4 FROM t6 WHERE t6.c14 IN (v1, v2) AND t6.c1 >= v3 AND t6.c1 <= v4) t2 LEFT JOIN (SELECT t7.c1, t7.c15, t7.c13, t7.c6, t7.c8, t7.c10 FROM (SELECT t8.c15, t8.c13 FROM t8) t7 JOIN (SELECT t9.c1, t9.c16, t9.c6 - t9.c17 AS c6, t9.c8 - t9.c18 AS c8, t9.c10 - t9.c19 AS c10 FROM t9 WHERE t9.c1 >= v3 AND t9.c1 <= v4) t10 ON t7.c13 = t10.c16) t3 ON t2.c4 = t3.c15 AND t2.c1 = t3.c1 LEFT JOIN (SELECT t11.c4, t11.c2 FROM t11) t4 ON t2.c4 = t4.c4 LEFT JOIN (SELECT t12.c15, t12.c20, t13.c21, CASE WHEN t13.c21 = v5 THEN v6 WHEN t13.c21 = v7 THEN v8 WHEN t13.c21 = v9 THEN v10 WHEN t13.c21 IS NULL THEN v11 WHEN t13.c21 = v12 THEN v11 ELSE v11 END AS c3 FROM t12 LEFT JOIN t13 ON t12.c20 = t13.c20) t5 ON t2.c4 = t5.c15 WHERE t3.c6 IS NOT NULL) WHERE t4.c2 IN (v13, v14, v15, v16, v17) GROUP BY t1.c1, t1.c2, t1.c3;
SELECT t1.c1, t1.c2, t1.c3, t2.c1 AS c4 FROM (SELECT c1 AS c1, from_unixtime(c2, 'yyyyMMddHHmmss') AS c2, substr(c3, 0, 8) AS c3, c4 FROM t1 WHERE c3 >= v1 AND c3 <= v2 AND c5 = v3 AND c6 = v4 AND c7 = 0) t1 JOIN (SELECT c1, c4 FROM t1 WHERE c3 >= v1 AND c3 <= v2 AND c4 != '' AND c1 != '') t2 ON t1.c4 = t2.c4 WHERE (c1 = v5 OR c1 = v6 OR c1 = v7 OR c1 = v8 OR c1 = v9 OR c1 = v10 OR c1 = v11 OR c1 = v12 OR c1 = v13 OR c1 = v14 OR c1 = v15 OR c1 = v16 OR c1 = v17 OR c1 = v18 OR c1 = v19 OR c1 = v20 OR c1 = v21 OR c1 = v22 OR c1 = v23) GROUP BY t1.c1, t1.c2, t1.c3, t2.c1
SELECT v1 AS c1, c2, c3, c4 FROM (SELECT t1.c2 AS c2, (NVL(t1.c3, 0) - NVL(t2.c3, 0)) AS c3, (NVL(t3.c3, 0) - NVL(t4.c3, 0)) AS c4 FROM (SELECT c2, c3 FROM t1 WHERE c5 = v1 AND c6 IN (v2, v3, v4, v5) AND c7 = v6) t1 LEFT JOIN (SELECT c2, c3 FROM t1 WHERE c5 = v7 AND c6 IN (v2, v3, v4, v5) AND c7 = v6) t2 ON t1.c2 = t2.c2 LEFT JOIN (SELECT c2, c3 FROM t1 WHERE c5 = v1 AND c7 = v6) t3 ON t1.c2 = t3.c2 LEFT JOIN (SELECT c2, c3 FROM t1 WHERE c5 = v7 AND c7 = v6) t4 ON t1.c2 = t4.c2) WHERE c3 > 0 OR c4 > 0
SELECT t1.c1, t1.c2, t1.c3, t2.c4, t3.c5 FROM (SELECT SUBSTR(c1, 1, 8) AS c1, c2 AS c2, COUNT(DISTINCT c3) AS c3 FROM t1 WHERE c4 = v1 AND c5 = v2 AND CAST(c1 AS INT) BETWEEN v3 AND v4 AND c2 IN (v5, v6) AND c7 = v7 GROUP BY SUBSTR(c1, 1, 8), c2) t1 LEFT JOIN (SELECT SUBSTR(c1, 1, 8) AS c1, c2 AS c2, COUNT(DISTINCT c3) AS c4 FROM t1 WHERE c4 = v8 AND c5 = v2 AND c6 = v9 AND CAST(c1 AS INT) BETWEEN v3 AND v4 AND c2 IN (v5, v6) AND c7 = v7 GROUP BY SUBSTR(c1, 1, 8), c2) t2 ON t1.c1 = t2.c1 AND t1.c2 = t2.c2 LEFT JOIN (SELECT SUBSTR(c1, 1, 8) AS c1, c2 AS c2, COUNT(DISTINCT c3) AS c5 FROM t1 WHERE c4 = v8 AND c5 = v2 AND c6 = v10 AND CAST(c1 AS INT) BETWEEN v3 AND v4 AND c2 IN (v5, v6) AND c7 = v7 GROUP BY SUBSTR(c1, 1, 8), c2) t3 ON t1.c1 = t3.c1 AND t1.c2 = t3.c2;
SELECT t1.c1, t1.c2, t2.c3, t3.c4, t4.c5, t5.c6, t6.c7 FROM (SELECT CAST(c1 / 100 AS int) AS c1, COUNT(*) AS c2 FROM t1 WHERE c1 >= v1 AND c1 <= v2 AND c3 = v3 GROUP BY CAST(c1 / 100 AS int)) t1 JOIN (SELECT CAST(c1 / 100 AS int) AS c1, COUNT(DISTINCT c4) AS c3 FROM t1 WHERE c1 >= v1 AND c1 <= v2 AND c3 = v3 GROUP BY CAST(c1 / 100 AS int)) t2 ON t2.c1 = t1.c1 JOIN (SELECT CAST(c1 / 100 AS int) AS c1, COUNT(DISTINCT c5) AS c4 FROM t1 WHERE c1 >= v1 AND c1 <= v2 AND c3 = v3 GROUP BY CAST(c1 / 100 AS int)) t3 ON t3.c1 = t2.c1 JOIN (SELECT c1, COUNT(*) AS c5 FROM t2 WHERE c1 >= v4 AND c1 <= v5 GROUP BY c1) t4 ON t4.c1 = t3.c1 JOIN (SELECT c1, COUNT(DISTINCT c6) AS c6 FROM t2 WHERE c1 >= v4 AND c1 <= v5 GROUP BY c1) t5 ON t5.c1 = t4.c1 JOIN (SELECT c1, COUNT(DISTINCT c7) AS c7 FROM t2 WHERE c1 >= v4 AND c1 <= v5 GROUP BY c1) t6 ON t6.c1 = t5.c1
SELECT count(*) FROM (SELECT c1, c2, c3, c4, c5, c6, c7, c8 FROM t1 WHERE c9 = v1 AND c10 = v2 AND c11 = v3) t2 LEFT OUTER JOIN (SELECT c12, c13, c14, c15, c16, c17, c18, c19, c20, c21, c22, c23, c24, c25, c26, c27, c28, c29 FROM (SELECT c12, c13, c14, c15, c16, c17, c18, c19, c20, c21, c22, c23, c24, c25, c26, c27, c28, c29, ROW_NUMBER() OVER (PARTITION BY c17, c24 ORDER BY c12 DESC, c25 DESC) AS c30 FROM (SELECT c12, c13, c14, c15, c16, c17, c18, c19, c20, c21, c22, c23, c24, c25, c26, c27, c28, c29 FROM t3 WHERE c9 = v1)) WHERE c30 = 1) t4 ON (t2.c2 = t4.c17 AND t2.c6 = t4.c24 AND t2.c1 = t4.c15 AND t2.c7 = t4.c27 AND t2.c8 = t4.c28) WHERE t4.c17 IS NULL
SELECT c1, COUNT(*) AS c2 FROM (SELECT CASE WHEN COUNT(DISTINCT c3) BETWEEN 1 AND 5 THEN '1-5' WHEN COUNT(DISTINCT c3) BETWEEN 6 AND 9 THEN '6-9' WHEN COUNT(DISTINCT c3) BETWEEN 10 AND 19 THEN '10-19' WHEN COUNT(DISTINCT c3) BETWEEN 20 AND 29 THEN '20-29' WHEN COUNT(DISTINCT c3) BETWEEN 30 AND 39 THEN '30-39' WHEN COUNT(DISTINCT c3) BETWEEN 40 AND 49 THEN '40-49' WHEN COUNT(DISTINCT c3) BETWEEN 50 AND 59 THEN '50-59' WHEN COUNT(DISTINCT c3) BETWEEN 60 AND 69 THEN '60-69' WHEN COUNT(DISTINCT c3) BETWEEN 70 AND 79 THEN '70-79' WHEN COUNT(DISTINCT c3) BETWEEN 80 AND 89 THEN '80-89' WHEN COUNT(DISTINCT c3) BETWEEN 90 AND 99 THEN '90-99' ELSE '100+' END AS c1, c4 FROM (SELECT c5 AS c3, c4 FROM t1 WHERE c6 BETWEEN v1 AND v2 AND c7 = v3 UNION SELECT c8 AS c3, c9 AS c4 FROM t2 WHERE c6 BETWEEN v1 AND v2 AND c10 IN (v4)) GROUP BY c4) GROUP BY c1
SELECT COUNT(DISTINCT t1.c1) AS c2 FROM (SELECT DISTINCT c1, c3, c4, IF (unix_timestamp(c5) >= unix_timestamp(v1) AND unix_timestamp(c5) < unix_timestamp(v2), 1, 0) AS c6, c7, (c8 + c9) AS c10 FROM t3 WHERE c2 = v3 ORDER BY rand(1) DESC) t1 LEFT JOIN (SELECT DISTINCT c1 FROM t4 WHERE c2 = v3 AND c11 = v4 AND c12 = v5) t2 ON t1.c1 = t2.c1 LEFT JOIN (SELECT c1 FROM (SELECT c1 FROM t5 UNION SELECT c1 FROM t6 UNION SELECT c1 FROM t7)) t3 ON t1.c1 = t3.c1 WHERE t1.c10 > 0 AND t1.c6 = 0 AND t1.c3 = 1 AND t1.c4 = 0 AND t2.c1 IS NULL AND t3.c1 IS NULL
SELECT t1.c1, t1.c2, t1.c3, t1.c4, t1.c5, t1.c6, t1.c3, t2.c7, t2.c8 FROM (SELECT ds, c1, c9, c10, c11, c4, c3, CASE WHEN c2 IS NULL OR c2 = '' THEN '' ELSE CAST(sm4_GCMDecryptNoPadding(hive_unbase64(substr(c2, 68)), `BINARY`(k1.c12), hive_unbase64(substr(c2, 26, 16)), 12, hive_unbase64(substr(c2, 1, 24)), hive_unbase64(substr(c2, 43, 24))) AS STRING) END AS c2, c5 FROM t1 LEFT JOIN (SELECT c12 FROM t2 LIMIT 1) k1 ON 1 = 1)t1 LEFT JOIN t2 ON t1.c1=t2.c1 WHERE t1.c9 IN(v1, v2) AND t1.c2='v3' AND t1.c11=504
SELECT * FROM (SELECT c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, v1 FROM (SELECT c1, c2, c3, c4, c5, c6, c7, c8, c9, c10 FROM t1 WHERE c11 = v1 AND c9 = v2 AND ((c12 < v2 AND from_unixtime(unix_timestamp(substr(c8, 0, 10), 'yyyy-MM-dd'), 'yyyyMMdd') < v1) OR c12 = v3) AND instr(NVL(c10, ''), v4) = v5 AND c2 = v6 UNION ALL SELECT c1, c2, c3, c4, c5, c6, c7, c8, c9, v7 AS c10 FROM t1 WHERE c11 = v1 AND from_unixtime(unix_timestamp(substr(c8, 0, 10), 'yyyy-MM-dd'), 'yyyyMMdd') <= v1 AND (c13 != v8 OR c14 != v8) AND instr(NVL(c10, ''), v4) != v5 AND c2 = v6)) t2
SELECT t1.c1, t1.c2, t1.c3, t2.c1 AS c4 FROM (SELECT c1 AS c1, from_unixtime(c2, 'yyyyMMddHHmmss') AS c2, substr(c3, 0, 8) AS c3, c4 FROM t1 WHERE c3 >= v1 AND c3 <= v2 AND c5 = v3 AND c6 = v4 AND c7 = 0) t1 JOIN (SELECT c8 AS c1, c4 FROM t1 WHERE c3 >= v1 AND c3 <= v2 AND c4 != '' AND c8 != '') t2 ON t1.c4 = t2.c4 WHERE (c8 = v5 OR c8 = v6 OR c8 = v7 OR c8 = v8 OR c8 = v9 OR c8 = v10 OR c8 = v11 OR c8 = v12 OR c8 = v13 OR c8 = v14) GROUP BY t1.c1, t1.c2, t1.c3, t2.c1
SELECT SUM(t2.c15) AS c15_alias FROM (SELECT t1.c1, t1.c2, t1.c3, t1.c4, t1.c5, t1.c6, t1.c7, t1.c8, t1.c9, t1.c10, t1.c11, t1.c12, t1.c13, t1.c14, t1.c15, ROW_NUMBER() OVER (PARTITION BY t1.c7, t1.c8, t1.c13 ORDER BY t1.c3 DESC, t1.c2 DESC) AS c16 FROM (SELECT CAST(t1.c1 AS BIGINT) AS c1, CAST(t1.c2 AS BIGINT) AS c2, CAST(t1.c3 AS BIGINT) AS c3, t1.c4, t1.c5, CAST(t1.c6 AS BIGINT) AS c6, CAST(t1.c7 AS BIGINT) AS c7, t1.c8, t1.c9, t1.c10, CAST(t1.c11 AS BIGINT) AS c11, CAST(t1.c12 AS BIGINT) AS c12, t1.c13, CASE WHEN array_contains(split(t1.c17, ';'), 'v1') THEN unbase64(t1.c14) ELSE t1.c14 END AS c14, CAST(t1.c15 AS BIGINT) AS c15 FROM t1 WHERE t1.c18 = 'v2') ) AS t2 WHERE t2.c16 = 1 AND t2.c12 = 2 AND t2.c9 = 'v3' AND t2.c10 = 'v4'
SELECT count(DISTINCT t1.c1) AS c2 FROM (SELECT t1.c1 AS c1, t2.c2 AS c3 FROM (SELECT c1 FROM t1 WHERE c2 <= v1 AND c2 >= v2 AND c3 = v3 AND c4 = v4 AND c5 = v5 AND c6 = v6) t1 LEFT JOIN (SELECT DISTINCT t3.c2 AS c2 FROM (SELECT c4, c5 FROM (SELECT c4, c5, row_number() OVER(PARTITION BY c4 ORDER BY c6 DESC, c7 DESC) AS c8 FROM t2 WHERE c2 <= v1 AND c2 >= v2 AND from_unixtime(CAST(c9 AS BIGINT), 'yyyyMMdd') <= v1 AND from_unixtime(CAST(c9 AS BIGINT), 'yyyyMMdd') >= v2) WHERE c8 = 1) t3 LEFT JOIN (SELECT c10, c11 FROM t3 WHERE c2 = v1) t4 ON t3.c5 = t4.c11 WHERE t4.c10 IS NOT NULL) t2 ON t1.c1 = t2.c2 WHERE t2.c2 IS NOT NULL) t1
SELECT COUNT(t1.c1) AS c1_alias1, COUNT(t2.c1) AS c1_alias2 FROM (SELECT c1, c2 FROM (SELECT regexp_extract(c3, ‘str0', 2) AS c1, regexp_extract(c3, 'str0', 3) AS c2 FROM t1 WHERE v1 <= c4 AND c4 <= v2) GROUP BY c1, c2) t1 LEFT JOIN (SELECT c1, c2, COUNT(1) AS c5 FROM (SELECT NVL(get_json_object(c6, ‘str1'), '') AS c2, NVL(c7, 0) AS c1 FROM t2 WHERE v1 <= c8 AND c8 <= v2 AND c9 = v3 AND c10 = v4 AND c11 = v5 AND c12 = v6) GROUP BY c1, c2) t2 ON t1.c1 = t2.c1 AND t1.c2 = t2.c2
SELECT c1, c2, c3, count(DISTINCT t1.c4) AS c5 FROM (SELECT c1, c4 FROM t1 WHERE c6 IN (v1, v2) AND c1 = v3) t1 LEFT JOIN (SELECT c4, c2 FROM t2) t2 ON t1.c4 = t2.c4 LEFT JOIN (SELECT t3.c7, t3.c8, t4.c9, CASE WHEN c9 = v4 THEN v5 WHEN c9 = v6 THEN v7 WHEN c9 = v8 THEN v9 WHEN c9 IS NULL THEN v10 WHEN c9 = v11 THEN v10 ELSE v10 END AS c3 FROM t3 LEFT JOIN t4 ON .c8 = t4.c8) t3 ON t1.c4 = t3.c7 WHERE c2 IN (v12, v13, v14, v15, v16) GROUP BY c1, c2, c3;
SELECT t1.c1, t1.c2, t1.c3, t1.c4, t2.c5 FROM (SELECT nvl(c1, 'v1') AS c1, nvl(c2, 'v1') AS c2, nvl(c3, 'v1') AS c3, count(DISTINCT c6) AS c4 FROM t1 WHERE c7 = v2 AND c3 IN (v3, v4, v5, v6) GROUP BY c1, c2, c3 WITH CUBE) t1 LEFT JOIN (SELECT c3, c5 FROM t1 WHERE c7 = v2 AND c3 IN (v3, v4, v5, v6) GROUP BY c3, c5) t2 ON t1.c3 = t2.c3
SELECT t1.c1, t1.c2, t1.c3, t1.c4, t1.c5 FROM (SELECT t1.c1 t1S c1, COUNT(DISTINCT t1.c2) t1S c2, SUM(t1.c3) t1S c3, COUNT(DISTINCT t1.c4, t1.c5) t1S c4, COUNT(DISTINCT t1.c6) t1S c5 FROM t1 WHERE t1.c7 != v1 t1ND t1.c8 = v2 t1ND t1.c9 = v3 GROUP BY t1.c1 UNION t1LL SELECT 0 t1S c1, COUNT(DISTINCT t1.c2) t1S c2, SUM(t1.c3) t1S c3, COUNT(DISTINCT t1.c4, t1.c5) t1S c4, COUNT(DISTINCT t1.c6) t1S c5 FROM t1 WHERE t1.c7 != v1 t1ND t1.c8 = v2 t1ND t1.c9 = v3) t1
SELECT t1.c4, t1.c5, SUM(t1.c6) AS c6 FROM (SELECT t2.c1, t2.c2, t2.c3, t2.c4, IF(t3.c1 IS NULL, 0, 1) AS c5, t4.c2 AS c6 FROM (SELECT c1, c2 AS c1, c3, c4 FROM t1 WHERE c5 = v1) t2 LEFT JOIN t2 t3 ON t2.c1 = t3.c1 LEFT JOIN (SELECT c1, COUNT(1) AS c2 FROM (SELECT NVL(get_json_object(c6, v2), v3) AS c1 FROM t3 WHERE v4 <= c7 AND c7 <= v5 AND c8 = v6 AND c9 = v7 AND c10 = v8 AND c11 = v9) GROUP BY c1 HAVING c1 <> v3) t4 ON t2.c2 = t4.c1) GROUP BY t1.c4, t1.c5
SELECT t1.c1 AS c1, t1.c2 AS c2, t1.c3 AS c3, nvl(COUNT(CASE WHEN t1.c4 = v1 THEN v2 END), v2) AS c5, nvl(SUM(CASE WHEN t1.c6 = v1 THEN v2 END), v2) AS c7, nvl(SUM(CASE WHEN t1.c6 = v3 THEN v2 END), v2) AS c8, nvl(COUNT(DISTINCT CASE WHEN t1.c4 = v1 THEN t1.c9 END), v2) AS c10, nvl(COUNT(DISTINCT CASE WHEN t1.c6 = v1 THEN t1.c9 END), v2) AS c11, nvl(COUNT(DISTINCT CASE WHEN t1.c6 = v3 THEN t1.c9 END), v2) AS c12 FROM t1 GROUP BY t1.c1, t1.c2, t1.c3
SELECT SUBSTR(t1.c1, 1, 8) AS c1_alias, t1.c3, COUNT(*) AS c2_alias FROM (SELECT c1, c5 AS c6, c3 FROM t1 WHERE c7 = 'v1' AND c1 >= v2 AND c1 <= v3 AND c8 LIKE 'v4' AND c9 != v5 AND c10 = 'v6' AND c11 = 'v7') t1 JOIN (SELECT c5 AS c6 FROM t1 WHERE c7 = 'v8' AND c1 >= v2 AND c1 <= v3 AND c8 LIKE 'v4' AND c9 != v5 AND c10 = 'v6' AND c11 = 'v7' AND c12 = 'v9') t2 ON t1.c6 = t2.c6 GROUP BY SUBSTR(t1.c1, 1, 8), t1.c3
SELECT AVG(c3) FROM (SELECT t1.c1, (t2.c2 - t1.c2) AS c3 FROM (SELECT c1, c2 FROM (SELECT c4 AS c1, c2, ROW_NUMBER() OVER (PARTITION BY c1 ORDER BY c2) AS c5 FROM t1 WHERE c6 = v1 AND c7 = v2) t1 WHERE t1.c5 = 1) t1 JOIN (SELECT c1, c2 FROM (SELECT c4 AS c1, c2 AS c2, ROW_NUMBER() OVER (PARTITION BY c1 ORDER BY c2) AS c5 FROM t1 WHERE c6 = v1 AND c7 = v3 AND c8 = v4) t2 WHERE t2.c5 = 1) t2 ON t1.c1 = t2.c1 AND t2.c2 > t1.c2) WHERE c3 > v5 AND c3 < v6;
SELECT a.c1, a.c2, a.c3, a.c4, b.c5 FROM (SELECT nvl(c1, 'v1') AS c1, nvl(c2, 'v1') AS c2, NVL(c3, 'v1') AS c3, count(DISTINCT c6) AS c4 FROM t1 WHERE c7 = v2 AND c3 IN (v3, v4) GROUP BY c1, c2, c3 WITH CUBE) a LEFT JOIN (SELECT c3, c5 FROM t1 WHERE c7 = v2 AND c3 IN (v3, v4) GROUP BY c3, c5) b ON a.c3 = b.c3
SELECT SUBSTR(t1.c1, 1, 6) AS c2, COUNT(DISTINCT t1.c3) AS c4, COUNT(DISTINCT t1.c5) AS c6, SUM(t1.c7) / 100 AS c8, COUNT(DISTINCT IF(t2.c9 = SUBSTR(t1.c1, 1, 6), t1.c3, NULL)) AS c10 FROM t1 LEFT JOIN (SELECT c1, c3, SUBSTR(c11, 1, 6) AS c9, SUBSTR(c12, 1, 6) AS c13 FROM t2 WHERE c1 = v1) t2 ON t1.c3 = t2.c3 WHERE t1.c1 >= v2 AND t1.c1 <= v3 GROUP BY SUBSTR(t1.c1, 1, 6);
SELECT count(DISTINCT t2.c1) FROM t1 RIGHT JOIN (SELECT t21.c1, t22.c2 FROM t21 JOIN (SELECT c1 AS c1_alias, CAST(get_json_object(unbase64(c3), '$.c4') AS DOUBLE) AS c2 FROM t3 WHERE c5 >= v1 AND c5 <= v2 AND c6 = v3 AND c7 = v4) t22 ON t21.c1 = t22.c1_alias WHERE c5 = v5 AND c8 = v6 AND t22.c2 < v7) t2 ON t1.c1 = t2.c1 WHERE t1.c9 = v5 AND t1.c2 >= v7
SELECT count(1) FROM (SELECT c1, c2, c3, c4, c5, c6, c7, c8, c9, c10 FROM t1 WHERE c11 = v1) t1 LEFT JOIN (SELECT DISTINCT c12 AS c13 FROM t2 WHERE c11 = v2 AND c14 = v3 AND c15 = v4) t2 ON t1.c1 = t2.c13 LEFT JOIN (SELECT c16 FROM t3 WHERE c11 = v2) t3 ON t1.c1 = t3.c16 WHERE t2.c13 IS NULL
SELECT t1.c1, t1.c2, t1.c3, COUNT(*) AS c4 FROM (SELECT t2.c5 AS c1, t2.c2, t2.c3, COUNT(*) OVER (PARTITION BY t2.c5) AS c6 FROM t2 WHERE t2.c7 = 'v1' AND t2.c8 BETWEEN v2 AND v3 AND t2.c9 LIKE 'v4' AND t2.c10 != v5 AND t2.c11 = 'v6' AND t2.c12 = 'v7' AND t2.c13 = 'v8' ) t1 WHERE t1.c2 = 'v9' AND t1.c6 > v10 GROUP BY t1.c1, t1.c2, t1.c3 ORDER BY t1.c1;
SELECT t1.c1, t1.c2, t1.c3, t1.c4, t2.c5, t2.c6 FROM t1 LEFT JOIN (SELECT c7, c8, COUNT(1) AS c5, SUM(c9) AS c6 FROM t2 WHERE v1 <= c10 AND c10 <= v2 GROUP BY c7, c8) t2 ON t1.c1 = t2.c7 AND t1.c3 = t2.c8 WHERE t1.c4 = v3
SELECT count(DISTINCT t1.c1) AS c1_num FROM (SELECT t2.c1 AS c1, t3.c2 AS c2 FROM (SELECT c1 FROM t1 WHERE c2 <= v1 AND c2 >= v2 AND c3 = v3 AND c4 = v4 AND c5 = v5 AND c6 = v6) t2 LEFT JOIN (SELECT DISTINCT c2 FROM t3 WHERE c2 = v7 AND c3 = v8) t3 ON t2.c1 = t3.c2 WHERE t3.c2 IS NOT NULL) t1
SELECT t1.c2, t1.c3, t1.c4, t2.c2 FROM (SELECT t1.c3, NVL(t1.c1, 0) AS c2, COUNT(t1.c5) AS c4 FROM t1 WHERE t1.c6 = v1 GROUP BY ROLLUP(t1.c3, t1.c1) HAVING GROUPING(t1.c3) = 0) t1 JOIN (SELECT NVL(t1.c1, 0) AS c2, COUNT(t1.c5) AS c2 FROM t1 WHERE t1.c6 = v1 GROUP BY ROLLUP(t1.c1)) t2 ON t1.c2 = t2.c2
SELECT t1.c1, t1.c2, t1.c3, t1.c4, t1.c5 FROM (SELECT t2.c1, t2.c6 AS c2, t2.c7 AS c3, t2.c8 AS c4, t2.c9 AS c5, row_number() over(PARTITION BY t2.c6 ORDER BY t2.c10 DESC, t2.c8 DESC) c11 FROM t2 WHERE t2.c1 >= v1 AND (t2.c6 = v2 OR t2.c6 = v3)) WHERE t1.c11 = 1
SELECT CASE WHEN t2.c2 = v1 THEN 1 WHEN t2.c2 = v2 THEN 2 ELSE 0 END AS c3, COUNT(t1.c1) AS c4 FROM (SELECT DISTINCT c1 FROM t1 WHERE c3 = v3 AND c4 > 0) t1 JOIN (SELECT DISTINCT c1, c2 FROM t2 WHERE c2 IN (v1, v2) AND c3 = v3) t2 ON t1.c1 = t2.c1 GROUP BY ROLLUP(c2)
SELECT COUNT(DISTINCT CASE WHEN c4 > 1000000 THEN t1.c1 ELSE NULL END) AS c5, COUNT(DISTINCT CASE WHEN c4 < 1000000 THEN t1.c1 ELSE NULL END) AS c6 FROM (SELECT c1, c2, c3, c4 FROM t1 WHERE c7 = v1 AND c8 IN (v2, v3) AND c2 > 0) t1 JOIN (SELECT DISTINCT c1 FROM t2 WHERE c9 = v4 AND c7 = v1) t2 ON t1.c1 = t2.c1
SELECT avg(c1) FROM (SELECT *, row_number() over(PARTITION BY c2 ORDER BY c3 DESC) AS c4 FROM (SELECT * FROM t1 WHERE c5 > v1 UNION ALL SELECT * FROM t2 WHERE c5 > v1) a) b WHERE c4 = 1 AND c6 IN (v2, v3, v4) AND c7 = v5
SELECT * FROM (SELECT c1, c2, c3, c4, c5, c6 FROM t1 WHERE c7 = v1 AND c8 = v2) NEW FULL JOIN (SELECT c1, c2, c3, c4, c6, c5 FROM t2 WHERE c7 = v1 AND c8 = v2) OLD ON new.c1 = old.c1 AND new.c2 = old.c2 WHERE new.c6 IS NULL OR old.c6 IS NULL OR new.c6 <> old.c6
SELECT count(*) FROM (SELECT concat('v1', substr(c1, -4, 3), 'v2', substr(c1, -1, 1)) AS c2, c1 FROM t1 WHERE c3 = v3 AND c4 IN (v4, v5)) temp_table1 LEFT JOIN (SELECT c1 FROM t1 WHERE c3 = v3 AND c1 NOT IN (v6, v7)) temp_table2 ON temp_table1.c1=temp_table2.c1 WHERE temp_table2.c1 IS NOT NULL
SELECT t1.c1, t1.c2, t1.c3, t1.c4, t1.c5, t1.c6 FROM (SELECT 0 AS c1, COUNT(DISTINCT t2.c7) AS c2, SUM(t2.c8) AS c3, COUNT(DISTINCT t2.c9, t2.c10) AS c4, COUNT(DISTINCT t2.c11) AS c5, t2.c12 AS c6 FROM t2 WHERE t2.c13 = v1 AND t2.c14 = v2 GROUP BY t2.c12) t1
SELECT avg(c1) FROM (SELECT *, row_number() over(PARTITION BY c2 ORDER BY c3 DESC) AS c4 FROM (SELECT * FROM t1 WHERE c5 > v1 UNION ALL SELECT * FROM t2 WHERE c5 > v1) a) b WHERE c4 = 1 AND c6 = v2
SELECT COUNT(DISTINCT t1.c1) AS c2_alias FROM (SELECT DISTINCT c1, c2 FROM t1 WHERE c2 != 0 AND c1 != 0 AND c3 = 0 AND c4 <= 'v2') t1 LEFT JOIN (SELECT c5, c6 FROM t2 WHERE c6 != 0 AND c5 = v3 AND c7 IN (v4)) t2 ON t1.c2 = t2.c6
SELECT t1.c1, t2.c2, t1.c3, t1.c4 FROM (SELECT c1, SUM(c2) / 100 AS c3, count(c3) AS c4 FROM t1 WHERE c4 >= v1 AND c4 <= v2 AND c5 = v3 GROUP BY c1) t1 LEFT JOIN (SELECT c6, c7 FROM t2) t2 ON t1.c1 = t2.c6 ORDER BY t1.c3 DESC
SELECT t1.c2, count(1) FROM (SELECT t1.c3, t1.c2, t1.c4, t1.c5, t1.c6, t1.c7, ROW_NUMBER() OVER (PARTITION BY t1.c3 ORDER BY t1.c8 DESC) AS c9 FROM t1 WHERE t1.c10 >= v1 AND t1.c10 <= v2) t1 WHERE t1.c9 = 1 AND t1.c4 = 1 GROUP BY t1.c2 ORDER BY t1.c2
SELECT t2.c2 FROM (SELECT c1 FROM t1 WHERE c2 = v1) t1 LEFT JOIN (SELECT c3, c2, c4, c5, c6 FROM t2 WHERE c7 > v2 AND c6 = v3 AND c4 = v4) t2 ON t1.c1 = t2.c2 WHERE t2.c2 IS NULL
SELECT t1.c1 FROM (SELECT c1 FROM t1 WHERE c2 = v1) t1 LEFT JOIN (SELECT c3, c4, c5, c6, c7 FROM t2 WHERE c8 > v2 AND c7 = v3 AND c5 = v4) t2 ON t1.c1 = t2.c4 WHERE t2.c4 IS NULL
SELECT SUM(t1.c6) AS c7 FROM (SELECT t2.c6 FROM (SELECT DISTINCT t3.c1, t3.c2, t3.c3, t3.c4, t3.c5, t3.c6 FROM t3 WHERE t3.c5 = v1 AND t3.c4 = v2 AND t3.c2 = v3 AND t3.c3 = v4) t2 WHERE t2.c5 = v1 AND t2.c4 = v2 AND t2.c2 = v3 AND t2.c3 = v4) AS t1;
