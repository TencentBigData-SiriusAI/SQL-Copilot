SELECT * FROM (SELECT t1.column0, t1.column1 AS column1_1, t1.column2, t1.column3, max(t1.column4) AS column4 FROM table0 t1 WHERE t1.column5 IN ('value0') AND t1.column0 IN('value1', 'value2') AND t1.column2 IN ('value3', 'value4', 'value5') AND t1.column3 BETWEEN 'value6' AND 'value7' AND t1.column6 = 'value8' AND t1.column4 = 0 GROUP BY t1.column0, t1.column1, t1.column2, t1.column3) a0 LEFT JOIN (SELECT t3.* FROM table1 t3 JOIN (SELECT column1, MAX(column6) AS column6 FROM table1 WHERE column6 > 'value9' GROUP BY column1) t2 ON t3.column1 = t2.column1 AND t3.column6 = t2.column6 WHERE t3.column6 > 'value9' ) a1 ON a0.column1_1 = a1.column1 WHERE ((column2 = 'value3' AND column0 = 'value1') AND ((column7 = 'value10') OR (column8 = 'value11' AND column9 IN ('value12', 'value13', 'value14', 'value15')) OR (column8 = 'value11' AND column10 IN ('value16')) OR (column8 = 'value11' AND column11 like '%value17%') OR (column8 = 'value11' AND column12 IN('value18', 'value19')))) OR ((column2 = 'value4' AND column0 = 'value1') AND ((column13 = 'value20') OR (column8 = 'value11' AND column14 IN ('value21', 'value22')) OR (column8 = 'value11' AND column9 IN ('value12')) OR (column8 = 'value11' AND column10 IN ('value23', 'value16')) OR (column8 = 'value11' AND column11 like '%value24%') OR (column8 = 'value11' AND column15 IN ('value25', 'value26')) OR (column8 = 'value11' AND column12 IN('value18', 'value19')))) OR (column2 = 'value5') OR (column2 = 'value3' AND column0 = 'value2') OR (column2 = 'value4' AND column0 = 'value2')
SELECT COUNT(*) AS SUM, column0, column1 FROM (SELECT CASE WHEN IFNULL(column0, 'UNKNOWN') = 'string0' THEN 'string0' ELSE 'string1' END AS column0, CASE WHEN ((CONCAT(NVL(column2, ''), NVL(column3, '')) RLIKE '.*string2.*' AND CONCAT(NVL(column2, ''), NVL(column3, '')) NOT RLIKE '.*string3.*') OR (NVL(column4, '') RLIKE '.*string4.*' AND NVL(column4, '') NOT RLIKE '.*string5.*') OR (CONCAT(NVL(column5, ''), NVL(column6, ''), NVL(column7, '')) RLIKE '.*string2.*') OR (CONCAT(NVL(column8, ''), NVL(column9, ''), NVL(column10, ''), NVL(column11, '')) RLIKE '.*string6.*' AND CONCAT(NVL(column8, ''), NVL(column9, ''), NVL(column10, ''), NVL(column11, '')) NOT RLIKE '.*string7.*')) AND NVL(column12, '') NOT RLIKE '.*string8.*' THEN 'string0' ELSE 'string1' END AS column1 FROM table0 whole_tb WHERE whole_tb.column13 = '20241030' AND column14 IS NOT NULL ) GROUP BY column0, column1 ;
SELECT table0.column8 AS column0, table0.column9 AS column1, table0.column10 AS column2, table0.column11 AS column3, table0.column4 AS column4, table0.column5 AS column5, table0.column12 AS column6, table0.column13 AS column7 FROM ( SELECT table1.column8 AS column8, table1.column9 AS column1, table1.column10 AS column2, table1.column11 AS column3, table1.column4 AS column4, table1.column5 AS column5, table1.column12 AS column12, table1.column13 AS column13 FROM ( SELECT column11, column10, column9, column8, column4, column5, column12, column13 FROM table2 WHERE column14 >= string1 AND column9 = string3 AND column15 IN (string4, string5) AND column4 = 1 AND column12 > 0 UNION ALL SELECT column11, column10, column9, column8, column4, column5, column12, column13 FROM (SELECT * FROM table3 WHERE column9 = string3 AND column14 = string0) t WHERE column15 IN (string4, string5) AND column4 = 1 AND column12 > 0 ) table1 LEFT JOIN (SELECT * FROM table4 WHERE column16 = string1 AND column1 = string3) table6 ON table1.column9 = table6.column1 WHERE table6.column1 IS NOT NULL AND table6.column17 <= string2 ) table0 LEFT JOIN ( SELECT table5.column10 AS column2, table5.column11 AS column3, column18 FROM ( SELECT column11, column10, column9, column12, column18 FROM table2 WHERE column14 >= string1 AND column15 IN (string6, string7) AND column4 = 1 ) table5 LEFT JOIN (SELECT * FROM table4 WHERE column16 = string1 AND column1 = string3) table6 ON table5.column9 = table6.column1 WHERE table6.column1 IS NOT NULL AND table6.column17 <= string2 ) table7 ON table0.column3 = table7.column3 WHERE table7.column3 IS NULL OR (table0.column12 != table7.column18)
SELECT column1, column2, column3, column4, column5, column6, column7, column8, column9, column10, CASE WHEN column11 IS NULL THEN NULL WHEN column11 = '' THEN '' ELSE cast(sm4_GCMDecryptNoPadding(hive_unbase64(substr(column11, 68)), `binary`(k.column0), hive_unbase64(substr(column11, 26, 16)), 12, hive_unbase64(substr(column11, 1, 24)), hive_unbase64(substr(column11, 43, 24))) AS STRING) END AS column11, CASE WHEN column12 IS NULL THEN NULL WHEN column12 = '' THEN '' ELSE cast(sm4_GCMDecryptNoPadding(hive_unbase64(substr(column12, 68)), `binary`(k.column0), hive_unbase64(substr(column12, 26, 16)), 12, hive_unbase64(substr(column12, 1, 24)), hive_unbase64(substr(column12, 43, 24))) AS STRING) END AS column12, CASE WHEN column13 IS NULL THEN NULL WHEN column13 = '' THEN '' ELSE cast(sm4_GCMDecryptNoPadding(hive_unbase64(substr(column13, 68)), `binary`(k.column0), hive_unbase64(substr(column13, 26, 16)), 12, hive_unbase64(substr(column13, 1, 24)), hive_unbase64(substr(column13, 43, 24))) AS STRING) END AS column13, CASE WHEN column14 IS NULL THEN NULL WHEN column14 = '' THEN '' ELSE cast(sm4_GCMDecryptNoPadding(hive_unbase64(substr(column14, 68)), `binary`(k.column0), hive_unbase64(substr(column14, 26, 16)), 12, hive_unbase64(substr(column14, 1, 24)), hive_unbase64(substr(column14, 43, 24))) AS STRING) END AS column14, column15, column16, column17, column18, CASE WHEN column19 IS NULL THEN NULL WHEN column19 = '' THEN '' ELSE cast(sm4_GCMDecryptNoPadding(hive_unbase64(substr(column19, 68)), `binary`(k.column0), hive_unbase64(substr(column19, 26, 16)), 12, hive_unbase64(substr(column19, 1, 24)), hive_unbase64(substr(column19, 43, 24))) AS STRING) END AS column19, column20, column21, column22, column23, column24, column25, column26, unix_timestamp(column26, 'yyyy-MM-dd HH:mm:ss') AS column26, unix_timestamp(column27, 'yyyy-MM-dd HH:mm:ss') AS column27, column28, column29, column30, column31, column32, column33, column34, column35, column36, column37, column38, unix_timestamp(column39, 'yyyy-MM-dd HH:mm:ss') AS column39 FROM table0 partition(p_20250101) p JOIN (SELECT column0 FROM table0 LIMIT 1) k ON (1 = 1) WHERE column1 = 100010000
SELECT count(*) FROM (SELECT column0, column1, column2, column3, column4, column5, column6, column7 FROM database0::table0 WHERE column8 = '20241219' AND column9 = 7 AND column10 = 2 ) order_table LEFT OUTER JOIN (SELECT column11, column12, column13, column14, column15, column16, column17, column18, column19, column20, column21, column22, column23, column24, column25, column26, column27, column28 FROM (SELECT column11, column12, column13, column14, column15, column16, column17, column18, column19, column20, column21, column22, column23, column24, column25, column26, column27, column28, ROW_NUMBER() OVER (PARTITION BY column16, column23 ORDER BY column11 DESC, column25 DESC) AS rn FROM (SELECT column11, column12, column13, column14, column15, column16, column17, column18, column19, column20, column21, column22, column23, column24, column25, column26, column27, column28 FROM database0::table1 WHERE column8 = '20241219' UNION ALL SELECT CAST(column11 AS BIGINT) AS column11, column12, column13, column14, CAST(column15 AS BIGINT) AS column15, CAST(column16 AS BIGINT) AS column16, CAST(column17 AS BIGINT) AS column17, CAST(column18 AS BIGINT) AS column18, CAST(column19 AS BIGINT) AS column19, CASE WHEN array_contains(split(column29, ';'), "13-B64") THEN unbase64(column21) ELSE column21 END AS column21, CAST(column22 AS BIGINT) AS column22, column23, CAST(column24 AS BIGINT) AS column24, CAST(column25 AS BIGINT) AS column25, CASE WHEN array_contains(split(column29, ';'), "16-B64") THEN unbase64(column26) ELSE column26 END AS column26, CASE WHEN array_contains(split(column29, ';'), "17-B64") THEN unbase64(column27) ELSE column27 END AS column27, CASE WHEN array_contains(split(column29, ';'), "18-B64") THEN unbase64(column28) ELSE column28 END AS column28 FROM database1::table2 WHERE column30 >= '2024122000' AND column30 <= '2024122023' AND column14 NOT LIKE "TestProject%" )) WHERE rn = 1 ) donation_record ON (order_table.column1 = donation_record.column16 AND order_table.column5 = donation_record.column23 AND order_table.column0 = donation_record.column14 AND order_table.column6 = donation_record.column26 AND order_table.column7 = donation_record.column27) WHERE donation_record.column16 IS NULL
SELECT CASE WHEN action_ = 'action0' THEN 'string0' WHEN action_ = 'action1' THEN 'string1' WHEN action_ = 'action2' THEN 'string2' WHEN action_ = 'action3' THEN 'string3' WHEN action_ = 'action4' THEN 'string4' WHEN action_ = 'action5' THEN 'string5' WHEN action_ = 'action6' THEN 'string6' WHEN action_ = 'action7' THEN 'string7' WHEN action_ = 'action8' THEN 'string8' WHEN action_ = 'action9' THEN 'string9' END AS action_name_, pv, uv FROM ( SELECT 'action0' AS action_, COUNT(*) AS pv, COUNT(DISTINCT column1) AS uv FROM table0 WHERE column0 >= 'date0' AND column0 <= 'date1' AND column2 = 'value0' AND column3 = 'value1' UNION ALL SELECT column4 AS action_, COUNT(*) AS pv, COUNT(DISTINCT column1) AS uv FROM table1 WHERE ds >= 'date0' AND ds <= 'date1' AND column4 IN ('action9', 'action8', 'action6', 'action7', 'action1', 'action2', 'action3', 'action4', 'action5') AND get_json_object(column5, '$.source') = 'value0' GROUP BY column4 )
SELECT column0, column1, column2, IF(column3 IS NULL OR column3 = '', column1, column3) column3, column4, column5, column6, column7, nvl(column8, column2) column8, nvl(column9, column10) column9, column10, IF(column9 IS NULL OR column9 = column10, 0, 1) column11 FROM (SELECT column0, max(column1) column1, max(column2) column2, column3, max(column4) column4, max(column5) column5, max(column6) column6, max(column7) column7, max(column8) column8, max(column9) column9, max(column12) column12, column10 FROM (SELECT column0_ column0, column1_ column1, max(IF(column2_ = '', NULL, column2_)) column2, regexp_extract(column1_, '(^[a-z_]+_|^wx)([a-z0-9]+)', 2) column3, max(IF(column4_ = '', NULL, column4_)) column4, max(IF(column5_ = '', NULL, column5_)) column5, max(IF(column6_ = '', NULL, column6_)) column6, max(IF(column7_ = '', NULL, column7_)) column7, max(IF(column8_ = '' OR column8_ = '0', NULL, column8_)) column8, max(IF(column9_ = '' OR column9_ = '0', NULL, column9_)) column9, max(IF(column6_ IS NOT NULL OR column6_ != '', column6_, column7_)) column12, column10_ column10 FROM table0::table1 partition(p_20241222) p WHERE column1_ IS NOT NULL AND column1_ != '' AND column1_ != '0' AND column0_ > 0 AND column10_ IS NOT NULL AND column10_ != '' AND column10_ != '0' GROUP BY column1_, column0_, column10_) GROUP BY column3, column0, column10) WHERE column3 = '2123591547938925dfc7aac86d19600001'
SELECT ds, city, mch_type, count(DISTINCT mchid) AS mch_activity, sum(cnt) AS cnt, sum(amount) / 100 AS amt_yuan, sum(fee) / 100 AS fee_yuan, sum(fee) / 900 AS fee_rl_yuan FROM (SELECT t1.mchid, t1.ds, t2.ftenpaymchid, t2.cnt, t2.amount, t2.fee, city, mch_type FROM (SELECT ds, mchid FROM table0 WHERE remark IN ("str1", "str2") AND ds >= 20241201 AND ds <= 20241231 ) t1 LEFT JOIN (SELECT ds, fmerchantid, ftenpaymchid, cnt, amount, fee FROM (SELECT fmerchantid, ftenpaymchid FROM table1) a1 JOIN (SELECT ds, frecipient_tenpay_merchant_no, pay_cnt - refund_cnt AS cnt, pay_amount - refund_amount AS amount, pay_fee - refund_fee AS fee FROM table2 WHERE ds >= 20241201 AND ds <= 20241231 ) a2 ON a1.ftenpaymchid = a2.frecipient_tenpay_merchant_no) t2 ON t1.mchid = t2.fmerchantid AND t1.ds = t2.ds LEFT JOIN (SELECT mchid, city FROM table3) t4 ON t1.mchid = t4.mchid LEFT JOIN (SELECT a1.fmerchantid, a1.fsubjectid, a2.FSubjectType, CASE WHEN FSubjectType = 2 THEN "str3" WHEN FSubjectType = 4 THEN "str4" WHEN FSubjectType = 2401 THEN "str5" WHEN FSubjectType IS NULL THEN "str6" WHEN FSubjectType = "\N" THEN "str6" ELSE "str6" END AS mch_type FROM table4 a1 LEFT JOIN table5 a2 ON a1.fsubjectid = a2.fsubjectid) t5 ON t1.mchid = t5.fmerchantid WHERE t2.cnt IS NOT NULL ) WHERE city IN ("str7", "str8", "str9", "str10", "str11") GROUP BY ds, city, mch_type;
SELECT column0, column1, column2, column3 FROM (SELECT column4 AS column0, from_unixtime(column5, 'yyyyMMddHHmmss') AS column1, substr(column6, 0, 8) AS column2, column7 FROM database0::table0 WHERE column6 >= 20241129 AND column6 <= 20241212 AND column8 = 'string0' AND column9 = 'string1' AND column10 = 0) t1 JOIN (SELECT column3, column7 FROM database0::table0 WHERE column6 >= 20241129 AND column6 <= 20241212 AND column7 != '' AND column3 != '') t2 ON t1.column7 = t2.column7 WHERE (column3 = 'string2' OR column3 = 'string3' OR column3 = 'string4' OR column3 = 'string5' OR column3 = 'string6' OR column3 = 'string7' OR column3 = 'string8' OR column3 = 'string9' OR column3 = 'string10' OR column3 = 'string11' OR column3 = 'string12' OR column3 = 'string13' OR column3 = 'string14' OR column3 = 'string15' OR column3 = 'string16' OR column3 = 'string17' OR column3 = 'string18' OR column3 = 'string19') GROUP BY column0, column1, column2, column3
SELECT value0 AS column5, column0, column6, column7 FROM ( SELECT table0.column0 AS column0, (NVL(table0.column1, 0) - NVL(table1.column1, 0)) AS column6, (NVL(table2.column1, 0) - NVL(table3.column1, 0)) AS column7 FROM ( SELECT column0, column1 FROM table0 WHERE column2 = value0 AND column3 IN (value2, value3, value4, value5) AND column4 = value6 ) table0 LEFT JOIN ( SELECT column0, column1 FROM table0 WHERE column2 = value1 AND column3 IN (value2, value3, value4, value5) AND column4 = value6 ) table1 ON table0.column0 = table1.column0 LEFT JOIN ( SELECT column0, column1 FROM table1 WHERE column2 = value0 AND column4 = value6 ) table2 ON table0.column0 = table2.column0 LEFT JOIN ( SELECT column0, column1 FROM table1 WHERE column2 = value1 AND column4 = value6 ) table3 ON table0.column0 = table3.column0 ) WHERE column6 > 0 OR column7 > 0;
SELECT sl.column0, sl.column1, sl.column7, ovns.column8, nrr.column9 FROM ( SELECT SUBSTR(column0, 1, 8) AS column0, column1 AS column1, COUNT(DISTINCT column2) AS column7 FROM table0 WHERE column3 = 'string0' AND column4 = 'string1' AND CAST(column0 AS INT) BETWEEN 2024111300 AND 2024113023 AND column1 IN ('0.45.1', '0.47.1') AND column6 = '1' GROUP BY SUBSTR(column0, 1, 8), column1 ) sl LEFT JOIN ( SELECT SUBSTR(column0, 1, 8) AS column0, column1 AS column1, COUNT(DISTINCT column2) AS column8 FROM table0 WHERE column3 = 'string2' AND column4 = 'string1' AND column5 = 'string3' AND CAST(column0 AS INT) BETWEEN 2024111300 AND 2024113023 AND column1 IN ('0.45.1', '0.47.1') AND column6 = '1' GROUP BY SUBSTR(column0, 1, 8), column1 ) ovns ON sl.column0 = ovns.column0 AND sl.column1 = ovns.column1 LEFT JOIN ( SELECT SUBSTR(column0, 1, 8) AS column0, column1 AS column1, COUNT(DISTINCT column2) AS column9 FROM table0 WHERE column3 = 'string2' AND column4 = 'string1' AND column5 = 'string4' AND CAST(column0 AS INT) BETWEEN 2024111300 AND 2024113023 AND column1 IN ('0.45.1', '0.47.1') AND column6 = '1' GROUP BY SUBSTR(column0, 1, 8), column1 ) nrr ON sl.column0 = nrr.column0 AND sl.column1 = nrr.column1;
SELECT a.ds, a.time_cnt, b.trade_cnt, c.user_cnt, d.click_help_time_cnt, e.click_help_trade_cnt, f.click_help_user_cnt FROM (SELECT cast(ds / 100 AS int) AS ds, count(*) AS time_cnt FROM table0::table1 WHERE ds >= 2024100800 AND ds <= 2024121823 AND column0 = 268547318 GROUP BY cast(ds / 100 AS int)) a JOIN (SELECT cast(ds / 100 AS int) AS ds, count(DISTINCT column1) AS trade_cnt FROM table0::table1 WHERE ds >= 2024100800 AND ds <= 2024121823 AND column0 = 268547318 GROUP BY cast(ds / 100 AS int)) b ON b.ds = a.ds JOIN (SELECT cast(ds / 100 AS int) AS ds, count(DISTINCT column2) AS user_cnt FROM table0::table1 WHERE ds >= 2024100800 AND ds <= 2024121823 AND column0 = 268547318 GROUP BY cast(ds / 100 AS int)) c ON c.ds = b.ds JOIN (SELECT ds, count(*) AS click_help_time_cnt FROM table3::table4 WHERE ds >= 20241008 AND ds <= 20241218 GROUP BY ds) d ON d.ds = c.ds JOIN (SELECT ds, count(DISTINCT column3) AS click_help_trade_cnt FROM table3::table4 WHERE ds >= 20241008 AND ds <= 20241218 GROUP BY ds) e ON e.ds = d.ds JOIN (SELECT ds, count(DISTINCT column4) AS click_help_user_cnt FROM table3::table4 WHERE ds >= 20241008 AND ds <= 20241218 GROUP BY ds) f ON f.ds = e.ds
SELECT count(*) FROM (SELECT column0, column1, column2, column3, column4, column5, column6, column7 FROM table0 WHERE column8 = 'string0' AND column9 = 7 AND column10 = 2 ) order_table LEFT OUTER JOIN (SELECT column11, column12, column13, column14, column15, column16, column17, column18, column19, column20, column21, column22, column23, column24, column25, column26, column27, column28 FROM (SELECT column11, column12, column13, column14, column15, column16, column17, column18, column19, column20, column21, column22, column23, column24, column25, column26, column27, column28, ROW_NUMBER() OVER (PARTITION BY column16, column23 ORDER BY column11 DESC, column25 DESC) AS column29 FROM (SELECT column11, column12, column13, column14, column15, column16, column17, column18, column19, column20, column21, column22, column23, column24, column25, column26, column27, column28 FROM table0 WHERE column8 = 'string0' )) WHERE column29 = 1 ) donation_record ON (order_table.column1 = donation_record.column16 AND order_table.column5 = donation_record.column23 AND order_table.column0 = donation_record.column14 AND order_table.column6 = donation_record.column26 AND order_table.column7 = donation_record.column27) WHERE donation_record.column16 IS NULL
SELECT column0, COUNT(*) AS column1 FROM ( SELECT CASE WHEN COUNT(DISTINCT column2) BETWEEN 1 AND 5 THEN 'range0' WHEN COUNT(DISTINCT column2) BETWEEN 6 AND 9 THEN 'range1' WHEN COUNT(DISTINCT column2) BETWEEN 10 AND 19 THEN 'range2' WHEN COUNT(DISTINCT column2) BETWEEN 20 AND 29 THEN 'range3' WHEN COUNT(DISTINCT column2) BETWEEN 30 AND 39 THEN 'range4' WHEN COUNT(DISTINCT column2) BETWEEN 40 AND 49 THEN 'range5' WHEN COUNT(DISTINCT column2) BETWEEN 50 AND 59 THEN 'range6' WHEN COUNT(DISTINCT column2) BETWEEN 60 AND 69 THEN 'range7' WHEN COUNT(DISTINCT column2) BETWEEN 70 AND 79 THEN 'range8' WHEN COUNT(DISTINCT column2) BETWEEN 80 AND 89 THEN 'range9' WHEN COUNT(DISTINCT column2) BETWEEN 90 AND 99 THEN 'range10' ELSE 'range11' END AS column0, column3 FROM ( SELECT column2 AS column2, column3 FROM table0 WHERE ds BETWEEN date0 AND date1 AND column4 = value0 UNION SELECT column5 AS column2, column6 AS column3 FROM table1 WHERE ds BETWEEN date0 AND date1 AND column7 IN ('value1') ) GROUP BY column3 ) GROUP BY column0
SELECT COUNT(DISTINCT table0.column0) AS uuid_cnt FROM (SELECT DISTINCT column0, column1, column2, IF (unix_timestamp(column3) >= unix_timestamp('date0') AND unix_timestamp(column3) < unix_timestamp('date1'), 1, 0) AS column4, column5, (column6 + column7) AS column8 FROM table1 WHERE column9 = 'value0' ORDER BY rand(1) DESC) table0 LEFT JOIN (SELECT DISTINCT column0 FROM table2 WHERE column9 = 'value0' AND column10 = 'value1' AND column11 = 'value2') table3 ON table0.column0 = table3.column0 LEFT JOIN (SELECT column12 FROM (SELECT column12 FROM table5 UNION SELECT column12 FROM table6 UNION SELECT column12 FROM table7)) table4 ON table0.column0 = table4.column12 WHERE table0.column8 > 'value3' AND table0.column4 = 'value3' AND table0.column1 = 'value2' AND table0.column2 = 'value3' AND table3.column0 IS NULL AND table4.column12 IS NULL
SELECT t1.column0, t1.column1, t1.column2, t1.column3, t1.column4, t1.column5, t1.column2, t2.column6, t2.column7 FROM (SELECT ds, column0, column8, column9, column10, column3, column5, column2, CASE WHEN column1 IS NULL OR column1 = '' THEN '' ELSE CAST(sm4_GCMDecryptNoPadding(hive_unbase64(substr(column1, 68)), `BINARY`(k1.column11), hive_unbase64(substr(column1, 26, 16)), 12, hive_unbase64(substr(column1, 1, 24)), hive_unbase64(substr(column1, 43, 24))) AS STRING) END AS column1, column4 FROM table0 partition(p_20241222)t0 LEFT JOIN (SELECT column11 FROM table1 LIMIT 1) k1 ON 1 = 1)t1 LEFT JOIN table2 partition(p_20241222)t2 ON t1.column0=t2.column0 WHERE t1.column8 IN(666538550, 670278753) AND t1.column1='445281200106222122' AND t1.column10=504
SELECT * FROM ( SELECT column0, column1, column2, column3, column4, column5, column6, column7, column8, column9, 20230101 FROM ( SELECT column0, column1, column2, column3, column4, column5, column6, column7, column8, column9 FROM table0 WHERE statis_day = 20230101 AND column8 = 2 AND ((column10 < 2 AND from_unixtime(unix_timestamp(substr(column7, 0, 10), 'yyyy-MM-dd'), 'yyyyMMdd') < '20230101') OR column10 = 1) AND instr(NVL(column9, ''), '|a|') = 0 AND column1 = 1234567890 UNION ALL SELECT column0, column1, column2, column3, column4, column5, column6, column7, column8, '|b|' AS column9 FROM table0 WHERE statis_day = 20230101 AND from_unixtime(unix_timestamp(substr(column7, 0, 10), 'yyyy-MM-dd'), 'yyyyMMdd') <= '20230101' AND (column11 != 0 OR column12 != 0) AND instr(NVL(column9, ''), '|a|') != 0 AND column1 = 1234567890 ) )
SELECT column0, real_time, statis_day, column7 FROM ( SELECT column0 AS column0, from_unixtime(column1, 'yyyyMMddHHmmss') AS real_time, substr(column2, 0, 8) AS statis_day, column3 FROM table0 WHERE column2 >= 20241231 AND column2 <= 20250113 AND column4 = 'string0' AND column5 = 'string1' AND column6 = 0 ) t1 JOIN ( SELECT column7, column3 FROM table0 WHERE column2 >= 20241231 AND column2 <= 20250113 AND column3 != '' AND column7 != '' ) t2 ON t1.column3 = t2.column3 WHERE (column7 = 'device0' OR column7 = 'device1' OR column7 = 'device2' OR column7 = 'device3' OR column7 = 'device4' OR column7 = 'device5' OR column7 = 'device6' OR column7 = 'device7' OR column7 = 'device8' OR column7 = 'device9') GROUP BY column0, real_time, statis_day, column7
SELECT SUM(column0) AS total_column0 FROM (SELECT column1, column2, column3, column4, column5, column6, column7, column8, column9, column10, column11, column12, column13, column14, column15, column16, ROW_NUMBER() OVER (PARTITION BY column7, column8, column13 ORDER BY column3 DESC, column2 DESC) AS rn FROM (SELECT CAST(column1 AS BIGINT) AS column1, CAST(column2 AS BIGINT) AS column2, CAST(column3 AS BIGINT) AS column3, column4, column5, CAST(column6 AS BIGINT) AS column6, CAST(column7 AS BIGINT) AS column7, column8, column9, column10, CAST(column11 AS BIGINT) AS column11, CAST(column12 AS BIGINT) AS column12, column13, CASE WHEN array_contains(split(column17, ';'), 'string0') THEN unbase64(column14) ELSE column14 END AS column14, CAST(column15 AS BIGINT) AS column15, CAST(column0 AS BIGINT) AS column0 FROM database0::table0 WHERE column18 = '2024121019' )) WHERE rn = 1 AND column12 = 2 AND column9 = 'string1' AND column10 = 'string2'
SELECT count(DISTINCT column0) AS column1 FROM (SELECT A.column0 AS column0, B.column2 AS column3 FROM (SELECT column0 FROM table0::table1 WHERE column4 <= 2024110123 AND column4 >= 2024102600 AND column5 = 'string0' AND column6 = 'string1' AND column7 = 'string2' AND column8 = 'string3' ) A LEFT JOIN (SELECT DISTINCT d2.column2 AS column2 FROM (SELECT column9, column10 FROM (SELECT column9, column10, row_number() OVER(PARTITION BY column9 ORDER BY column11 DESC, column12 DESC) AS column13 FROM table2::table3 WHERE column4 <= 2024110123 AND column4 >= 2024102600 AND from_unixtime(CAST(column14 AS BIGINT), 'yyyyMMdd') <= 20241101 AND from_unixtime(CAST(column14 AS BIGINT), 'yyyyMMdd') >= 20241026 ) WHERE column13 = 1 ) d1 LEFT JOIN (SELECT column2, column15 FROM table4::table5 WHERE column4 = 20241101 ) d2 ON d1.column10 = d2.column15 WHERE d2.column2 IS NOT NULL) B ON A.column0 = B.column2 WHERE B.column2 IS NOT NULL )
SELECT COUNT(t_reddot.column0) AS column1, COUNT(t_cardpv.column0) AS column2 FROM (SELECT column0, column3 FROM (SELECT regexp_extract(column4, '/nearbyminishopfeedreddot_(usershop)_(\\d*)_(\\w*)/count', 2) AS column0, regexp_extract(column4, '/nearbyminishopfeedreddot_(usershop)_(\\d*)_(\\w*)/count', 3) AS column3 FROM database0::table0 WHERE 2024121900 <= column5 AND column5 <= 2024121923) GROUP BY column0, column3) t_reddot LEFT JOIN (SELECT column0, column3, COUNT(1) AS column6 FROM (SELECT NVL(get_json_object(column7, '$.shopId'), '') AS column3, NVL(column8, 0) AS column0 FROM database1::table1 WHERE 2024121900 <= column9 AND column9 <= 2024121923 AND column10 = 'string0' AND column11 = 'string1' AND column12 = 'string2' AND column13 = 'string3') GROUP BY column0, column3) t_cardpv ON t_reddot.column0 = t_cardpv.column0 AND t_reddot.column3 = t_cardpv.column3
SELECT column0, column2, column3, count(DISTINCT t1.column1) AS mch_num FROM (SELECT column0, column1 FROM table0 WHERE column4 IN ("string0", "string1") AND column0 = "string2" ) t1 LEFT JOIN (SELECT column1, column2 FROM table1) t2 ON t1.column1 = t2.column1 LEFT JOIN (SELECT a1.column6, a1.column7, a2.column5, CASE WHEN column5 = 2 THEN "string4" WHEN column5 = 4 THEN "string5" WHEN column5 = 2401 THEN "string6" WHEN column5 IS NULL THEN "string7" WHEN column5 = "\N" THEN "string7" ELSE "string7" END AS column3 FROM table2 PARTITION (string8) a1 LEFT JOIN table3 PARTITION (string8) a2 ON a1.column7 = a2.column7) t3 ON t1.column1 = t3.column6 WHERE column2 IN ("string3", "string3", "string3", "string3", "string3") GROUP BY column0, column2, column3;
SELECT a.column0, a.column1, a.column2, a.column3, b.column4 FROM (SELECT nvl(column0, 'str0') AS column0, nvl(column1, 'str0') AS column1, NVL(column2, 'str0') AS column2, count(DISTINCT column5) AS column3 FROM table0 WHERE column6 = 20241111 AND column2 IN ('str1', 'str2', 'str3', 'str4') GROUP BY column0, column1, column2 WITH CUBE) a LEFT JOIN (SELECT column2, column4 FROM table0 WHERE column6 = 20241111 AND column2 IN ('str1', 'str2', 'str3', 'str4') GROUP BY column2, column4) b ON a.column2 = b.column2
SELECT column0, column9, column10, column11, column12 FROM ( SELECT a.column0 AS column0, COUNT(DISTINCT a.column1) AS column9, SUM(a.column2) AS column10, COUNT(DISTINCT a.column3, a.column4) AS column11, COUNT(DISTINCT a.column5) AS column12 FROM table0 a WHERE a.column6 != 5 AND a.column7 = 'string0' AND a.column8 = 'string1' GROUP BY a.column0 UNION ALL SELECT 0 AS column0, COUNT(DISTINCT a.column1) AS column9, SUM(a.column2) AS column10, COUNT(DISTINCT a.column3, a.column4) AS column11, COUNT(DISTINCT a.column5) AS column12 FROM table0 a WHERE a.column6 != 5 AND a.column7 = 'string0' AND a.column8 = 'string1' )
SELECT column2, column4, SUM(column5) AS column5 FROM ( SELECT table1.column1, table1.column0, table1.column7, table1.column2, IF(table3.column3 IS NULL, 0, 1) AS column4, table5.column5 FROM ( SELECT column0, column1 AS column3, column7, column2 FROM table0 WHERE column6 = 20230101 ) table1 LEFT JOIN table2 table3 ON table1.column3 = table3.column3 LEFT JOIN ( SELECT column7, COUNT(1) AS column5 FROM ( SELECT NVL(get_json_object(action_value_, '$.column7'), '') AS column7 FROM table4 WHERE 2023010100 <= ds AND ds <= 2023010123 AND sys_id_ = '1234567890123456' AND mode_ = 'release_mode' AND page_ = 'page_path' AND action_ = 'action_type' ) GROUP BY column7 HAVING column7 <> '' ) table5 ON table1.column0 = table5.column7 ) GROUP BY column2, column4
SELECT t_join.column0 AS column0, t_join.column1 AS column1, t_join.column2 AS column2, nvl(COUNT(CASE WHEN t_join.column3 = 'value0' THEN 1 END), 0) AS column4, nvl(SUM(CASE WHEN t_join.column5 = 'value1' THEN 1 END), 0) AS column6, nvl(SUM(CASE WHEN t_join.column5 = 'value2' THEN 1 END), 0) AS column7, nvl(COUNT(DISTINCT CASE WHEN t_join.column3 = 'value0' THEN t_join.column8 END), 0) AS column9, nvl(COUNT(DISTINCT CASE WHEN t_join.column5 = 'value1' THEN t_join.column8 END), 0) AS column10, nvl(COUNT(DISTINCT CASE WHEN t_join.column5 = 'value2' THEN t_join.column8 END), 0) AS column11 FROM database0::table0 t_join GROUP BY t_join.column0, t_join.column1, t_join.column2
SELECT SUBSTR(t1.column0, 1, 8) AS dataDate, t1.column1, COUNT(*) AS pvNumber FROM (SELECT column0, column3 AS cover_session_id, column1 FROM table0 WHERE column2 = 'value0' AND column0 >= 2024111300 AND column0 <= 2024112224 AND column4 LIKE 'X8AZ%' AND column5 != 2 AND column6 = '0.45.1' AND column7 = 'value1') t1 JOIN (SELECT column3 AS cover_session_id FROM table0 WHERE column2 = 'value2' AND column0 >= 2024111300 AND column0 <= 2024112224 AND column4 LIKE 'X8AZ%' AND column5 != 2 AND column6 = '0.45.1' AND column7 = 'value1' AND column8 = 'value3') t2 ON t1.cover_session_id = t2.cover_session_id GROUP BY SUBSTR(t1.column0, 1, 8), t1.column1
SELECT AVG(column0) FROM (SELECT column1, (column2 - column3) AS column0 FROM (SELECT column1, column3 FROM (SELECT column4 AS column1, column3, ROW_NUMBER() OVER (PARTITION BY column1 ORDER BY column3) AS column5 FROM table0 WHERE column6 = string0 AND column7 = string1 ) column8 WHERE column8.column5 = 1 ) column9 JOIN (SELECT column1, column2 FROM (SELECT column4 AS column1, column3 AS column2, ROW_NUMBER() OVER (PARTITION BY column1 ORDER BY column3) AS column5 FROM table0 WHERE column6 = string0 AND column7 = string2 AND column10 = string3 ) column11 WHERE column11.column5 = 1 ) column12 ON column9.column1 = column12.column1 AND column12.column2 > column9.column3) WHERE column0 > 2999 AND column0 < 6000;
SELECT a.column0, a.column1, a.column2, a.column3, b.column4 FROM (SELECT nvl(column0, 'string0') AS column0, nvl(column1, 'string0') AS column1, NVL(column2, 'string0') AS column2, count(DISTINCT column5) AS column3 FROM database0::table0 WHERE column6 = 20241111 AND column2 IN ('string1', 'string2') GROUP BY column0, column1, column2 WITH CUBE) a LEFT JOIN (SELECT column2, column4 FROM database0::table0 WHERE column6 = 20241111 AND column2 IN ('string1', 'string2') GROUP BY column2, column4) b ON a.column2 = b.column2
SELECT SUBSTR(a0.column0, 1, 6) AS d, COUNT(DISTINCT a0.column1) AS count_uin, COUNT(DISTINCT a0.column2) AS count_num, SUM(a0.column3) / 100 AS sum_money_yuan, COUNT(DISTINCT IF(a1.column4 = SUBSTR(a0.column0, 1, 6), a0.column1, NULL)) AS first_count_uin FROM table0 a0 LEFT JOIN (SELECT column0, column1, SUBSTR(column5, 1, 6) AS column4, SUBSTR(column6, 1, 6) AS column7 FROM table1 WHERE column0 = '20241228' ) a1 ON a0.column1 = a1.column1 WHERE a0.column0 >= '20240901' AND a0.column0 <= '20241228' GROUP BY SUBSTR(a0.column0, 1, 6);
SELECT count(DISTINCT t2.column0) FROM table0 t1 RIGHT JOIN ( SELECT t21.column0, t22.column1 FROM table1 AS t21 JOIN ( SELECT column0_, CAST(get_json_object(unbase64(column7), '$.column1') AS DOUBLE) AS column1 FROM table2 WHERE column2 >= 2024120100 AND column2 <= 2024120123 AND column3 = 'string0' AND column4 = 'string1' ) t22 ON t21.column0 = t22.column0_ WHERE column2 = 20241201 AND column5 = 'string2' AND t22.column1 < 35 ) t2 ON t1.column0 = t2.column0 WHERE t1.column6 = 20241201 AND t1.column1 >= 35
SELECT count(1) FROM ( SELECT column0, column1, column2, column3, column4, column5, column6, column7, column8, column9 FROM table0 WHERE ds = 'string0' ) merchant_docs LEFT JOIN ( SELECT DISTINCT column12 AS column0 FROM table1 WHERE ds = 'string1' AND column10 = 'string2' AND column11 = 'string3' ) RULE ON merchant_docs.column0 = rule.column0 LEFT JOIN ( SELECT column13 FROM table2 WHERE ds = 'string1' ) fund ON merchant_docs.column0 = fund.column13 WHERE rule.column0 IS NULL
SELECT column0, column1, column2, COUNT(*) AS column11 FROM ( SELECT column5 AS column0, column1, column2, COUNT(*) OVER (PARTITION BY column5) AS column10 FROM table0 WHERE column3 = 'string0' AND column4 BETWEEN 'string1' AND 'string2' AND column5 LIKE 'string3' AND column6 != 'string4' AND column7 = 'string5' AND column8 = 'string6' AND column9 = 'string7' ) WHERE column1 = 'string8' AND column10 > 3 GROUP BY column0, column1, column2 ORDER BY column0;
SELECT table0.column0, table0.column1, table0.column2, table0.column3, table1.column4, table1.column5 FROM database0::table0 table0 LEFT JOIN ( SELECT column6, column7, COUNT(1) AS column4, SUM(column8) AS column5 FROM database1::table2 WHERE '20241210' <= column9 AND column9 <= '20241219' GROUP BY column6, column7 ) table1 ON table0.column0 = table1.column6 AND table0.column2 = table1.column7 WHERE table0.column3 = 2
SELECT count(DISTINCT column0) AS uin_num FROM ( SELECT A.column2 AS column0, B.column3 AS column1 FROM ( SELECT column2 FROM table0 WHERE ds <= date0 AND ds >= date1 AND sys_id_ = 'string0' AND page_ = 'string1' AND action_ = 'string2' AND module_ = 'string3' ) A LEFT JOIN ( SELECT DISTINCT column3 FROM table1 WHERE ds = date2 AND fchanneltype = number0 ) B ON A.column2 = B.column3 WHERE B.column3 IS NOT NULL )
SELECT table2.column0, table2.column1, table2.column2, table3.column3 FROM ( SELECT column1, NVL(column0, 0) AS column0, COUNT(column4) AS column2 FROM table0 WHERE column5 = value0 GROUP BY ROLLUP(column1, column0) HAVING GROUPING(column1) = 0 ) table2 JOIN ( SELECT NVL(column0, 0) AS column0, COUNT(column4) AS column3 FROM table0 WHERE column5 = value0 GROUP BY ROLLUP(column0) ) table3 ON table2.column0 = table3.column0
SELECT column0, column1, column2, column3, column4 FROM ( SELECT column0, column5 AS column1, column6 AS column2, column7 AS column3, column8 AS column4, row_number() over(PARTITION BY column5 ORDER BY column9 DESC, column7 DESC) row_id FROM table0 WHERE column0 >= 202412301800 AND (column5 = 'string0' OR column5 = 'string1') ) WHERE row_id = 1
SELECT CASE WHEN column1 = 2 THEN 1 WHEN column1 = 3 THEN 2 ELSE 0 END AS column1, COUNT(table2.column0) AS column4 FROM (SELECT DISTINCT column0 FROM table0 WHERE column2 = 20230101 AND column3 > 0) table2 JOIN (SELECT DISTINCT column0, column1 FROM table1 WHERE column1 IN (2, 3) AND column2 = 20230101) table3 ON table2.column0 = table3.column0 GROUP BY ROLLUP(column1)
SELECT COUNT(DISTINCT CASE WHEN column3 > string4 THEN column0 ELSE NULL END) AS string5, COUNT(DISTINCT CASE WHEN column3 < string4 THEN column0 ELSE NULL END) AS string6 FROM (SELECT column0, column1, column2, column3 FROM table0 WHERE column4 = string0 AND column6 IN (string1, string2) AND column1 > 0 ) target_data JOIN (SELECT DISTINCT column0 FROM table1 WHERE column5 = string3 AND column4 = string0 ) fauthen_account ON target_data.column0 = fauthen_account.column0
SELECT avg(column0) FROM (SELECT *, row_number() over(PARTITION BY column1 ORDER BY column2 DESC ) AS id FROM (SELECT * FROM database0::table0 WHERE column3 > '20220201' UNION ALL SELECT * FROM database0::table1 WHERE column3 > '20220201' ) a) b WHERE id = 1 AND column4 IN (2128244, 2134572, 2220533) AND column5 = 486414
SELECT * FROM ( SELECT column0, column1, column2, column3, column4, column5 FROM table0 WHERE ds=202301 AND mchid=123456789 ) NEW FULL JOIN ( SELECT column0, column1, column2, column3, column5, column4 FROM table1 WHERE ds=202301 AND mchid=123456789 ) OLD ON new.column0 = old.column0 AND new.column1 = old.column1 WHERE new.column5 IS NULL OR old.column5 IS NULL OR new.column5 <> old.column5
SELECT count(*) FROM ( SELECT concat('prefix_', substr(column0, -4, 3), 'suffix_', substr(column0, -1, 1)) AS groupdb_id, column0 FROM table0 WHERE column1 = 2023010100 AND column2 IN (1, 2) ) pay LEFT JOIN ( SELECT column0 FROM table1 WHERE column1 = 2023010100 AND column3 NOT IN (3, 4) ) bill ON pay.column0 = bill.column0 WHERE bill.column0 IS NOT NULL
SELECT column0, column1, column2, column3, column4, column5 FROM (SELECT 0 AS column0, COUNT(DISTINCT table0.column6) AS column1, SUM(table0.column7) AS column2, COUNT(DISTINCT table0.column8, table0.column9) AS column3, COUNT(DISTINCT table0.column10) AS column4, table0.column5 AS column5 FROM database0::table0 WHERE table0.column11 = 20231125 AND table0.column12 = 3 GROUP BY table0.column5)
SELECT avg(column0) FROM (SELECT *, row_number() over(PARTITION BY column1 ORDER BY column2 DESC ) AS id FROM (SELECT * FROM database0::table0 WHERE column3 > '20220201' UNION ALL SELECT * FROM database0::table1 WHERE column3 > '20220201' ) a) b WHERE id = 1 AND column4=2134572
SELECT COUNT(DISTINCT t1.column0) AS count_zhusao FROM (SELECT DISTINCT column0, column1 FROM table0 WHERE column1 != 0 AND column0 != 0 AND column2 = 0 AND column3 <= '2023-01-01 00:00:00') t1 LEFT JOIN (SELECT column4, column5 FROM table1 WHERE column5 != 0 AND column4 = 20230101 AND column6 IN (10)) t2 ON t1.column1 = t2.column5
SELECT column0, column1, column2, column3 FROM ( SELECT column0, SUM(column4) / 100 AS column2, COUNT(column5) AS column3 FROM table0 WHERE column6 >= date0 AND column6 <= date1 AND column7 = value0 GROUP BY column0 ) t1 LEFT JOIN ( SELECT column8, column1 FROM table1 ) t2 ON t1.column0 = t2.column8 ORDER BY column2 DESC
SELECT column0, count(1) FROM ( SELECT column1, column0, column2, column3, column4, column5, ROW_NUMBER() OVER (PARTITION BY column1 ORDER BY column6 DESC) AS r FROM table0 WHERE column7 >= 2023010101 AND column7 <= 2023010103 ) WHERE r = 1 AND column2 = 12345 GROUP BY column0 ORDER BY column0
SELECT t2.column3 FROM (SELECT column0 FROM table0 WHERE column1 = value0) t1 LEFT JOIN (SELECT column2, column3, column4, column5, column6 FROM table1 WHERE ds > value1 AND column6 = value2 AND column4 = value3) t2 ON t1.column0 = t2.column3 WHERE t2.column3 IS NULL
SELECT t1.column0 FROM (SELECT `column0` FROM table0 WHERE column1 = 'value0' ) t1 LEFT JOIN (SELECT column2, column3, column4, column5, column6 FROM table1 WHERE column7 > 'value1' AND column6 = 3 AND column4 = 'value2' ) t2 ON t1.column0 = t2.column3 WHERE t2.column3 IS NULL
SELECT SUM(column0) AS sum_column0 FROM (SELECT a0.column0 FROM (SELECT DISTINCT column1, column2, column3, column4, column5, column0 FROM table0) a0 WHERE column5 = string0 AND column4 = string1 AND column2 = string2 AND column3 = string3 ) AS unique_records;
